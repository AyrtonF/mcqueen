{
  "info": {
    "_postman_id": "mcqueen-email-service-v2",
    "name": "Mcqueen Email Service API",
    "description": "Cole√ß√£o completa para testar todos os endpoints do Email Service.\n\nEsta cole√ß√£o inclui:\n- Envio de emails com formul√°rio\n- Consulta de hist√≥rico\n- Health checks\n- Exemplos de erros.\n\n",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:8080",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "üì§ Email Sending",
      "item": [
        {
          "name": "Enviar Email - Formul√°rio Multipart",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Response has required fields\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('status');",
                  "    pm.expect(jsonData).to.have.property('message');",
                  "    pm.expect(jsonData).to.have.property('sendDate');",
                  "    pm.expect(jsonData).to.have.property('recipient');",
                  "});",
                  "",
                  "pm.test(\"Status is SUCCESS\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.status).to.eql(\"SUCCESS\");",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "organizationName",
                  "value": "Secretaria da Sa√∫de",
                  "type": "text",
                  "description": "Nome do √≥rg√£o respons√°vel"
                },
                {
                  "key": "responsibleContact",
                  "value": "responsavel@saude.pe.gov.br",
                  "type": "text",
                  "description": "Email do respons√°vel pelo envio"
                },
                {
                  "key": "subject",
                  "value": "Dados de Sa√∫de P√∫blica",
                  "type": "text",
                  "description": "Tema principal dos dados"
                },
                {
                  "key": "referencePeriod",
                  "value": "2022-2024",
                  "type": "text",
                  "description": "Per√≠odo de refer√™ncia dos dados"
                },
                {
                  "key": "dataDescription",
                  "value": "Dados estat√≠sticos de atendimentos hospitalares, incluindo informa√ß√µes sobre interna√ß√µes, consultas ambulatoriais e procedimentos cir√∫rgicos realizados no per√≠odo de 2022 a 2024. Os dados foram coletados de todos os hospitais da rede p√∫blica estadual.",
                  "type": "text",
                  "description": "Descri√ß√£o detalhada do conte√∫do"
                },
                {
                  "key": "lgpdCompliance",
                  "value": "true",
                  "type": "text",
                  "description": "Confirma√ß√£o de conformidade com LGPD"
                },
                {
                  "key": "files",
                  "type": "file",
                  "src": "/path/to/your/sample.csv",
                  "description": "Arquivo CSV com os dados (SUBSTITUA PELO CAMINHO DO SEU ARQUIVO)"
                },
                {
                  "key": "recipient",
                  "value": "teste@exemplo.com",
                  "type": "text",
                  "description": "Email de destino (opcional)"
                }
              ]
            },
            "url": {
              "raw": "{{base_url}}/api/emails/send",
              "host": ["{{base_url}}"],
              "path": ["api", "emails", "send"]
            },
            "description": "Envia um email com dados do formul√°rio e anexos CSV.\n\n**IMPORTANTE:** \n- Substitua o caminho do arquivo CSV por um arquivo real em seu sistema\n- Todos os par√¢metros foram atualizados para ingl√™s"
          },
          "response": [
            {
              "name": "Sucesso - Email Enviado",
              "originalRequest": {
                "method": "POST",
                "header": [],
                "body": {
                  "mode": "formdata",
                  "formdata": [
                    {
                      "key": "organizationName",
                      "value": "Secretaria da Sa√∫de",
                      "type": "text"
                    },
                    {
                      "key": "responsibleContact",
                      "value": "responsavel@saude.pe.gov.br",
                      "type": "text"
                    },
                    {
                      "key": "subject",
                      "value": "Dados de Sa√∫de P√∫blica",
                      "type": "text"
                    },
                    {
                      "key": "referencePeriod",
                      "value": "2022-2024",
                      "type": "text"
                    },
                    {
                      "key": "dataDescription",
                      "value": "Dados estat√≠sticos de atendimentos hospitalares",
                      "type": "text"
                    },
                    {
                      "key": "lgpdCompliance",
                      "value": "true",
                      "type": "text"
                    },
                    {
                      "key": "files",
                      "type": "file",
                      "src": "dados_saude.csv"
                    }
                  ]
                },
                "url": {
                  "raw": "{{base_url}}/api/emails/send",
                  "host": ["{{base_url}}"],
                  "path": ["api", "emails", "send"]
                }
              },
              "status": "OK",
              "code": 200,
              "_postman_previewlanguage": "json",
              "header": [
                {
                  "key": "Content-Type",
                  "value": "application/json"
                }
              ],
              "cookie": [],
              "body": "{\n  \"status\": \"SUCCESS\",\n  \"message\": \"Email enviado com sucesso\",\n  \"sendDate\": \"2025-10-06T10:30:00\",\n  \"recipient\": \"gabriel.almeida1@sad.pe.gov.br\",\n  \"fileCount\": 1,\n  \"fileNames\": [\"dados_saude.csv\"]\n}"
            }
          ]
        },
        {
          "name": "Enviar Email - JSON + Multipart",
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "formData",
                  "value": "{\n  \"organizationName\": \"Secretaria de Educa√ß√£o\",\n  \"responsibleContact\": \"educacao@pe.gov.br\",\n  \"subject\": \"Dados Educacionais\",\n  \"referencePeriod\": \"2023-2024\",\n  \"dataDescription\": \"Estat√≠sticas de matr√≠culas e aprova√ß√µes nas escolas estaduais\",\n  \"lgpdCompliance\": true\n}",
                  "type": "text",
                  "contentType": "application/json"
                },
                {
                  "key": "files",
                  "type": "file",
                  "src": "/path/to/your/matriculas.csv",
                  "description": "SUBSTITUA PELO CAMINHO DO SEU ARQUIVO"
                },
                {
                  "key": "recipient",
                  "value": "destino@exemplo.com",
                  "type": "text"
                }
              ]
            },
            "url": {
              "raw": "{{base_url}}/api/emails/send-json",
              "host": ["{{base_url}}"],
              "path": ["api", "emails", "send-json"]
            },
            "description": "Alternativa usando JSON para dados do formul√°rio e multipart para arquivos"
          }
        }
      ]
    },
    {
      "name": "üìä Hist√≥rico e Consultas",
      "item": [
        {
          "name": "Consultar Hist√≥rico Completo",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/emails/history",
              "host": ["{{base_url}}"],
              "path": ["api", "emails", "history"]
            },
            "description": "Retorna todo o hist√≥rico de emails enviados"
          }
        },
        {
          "name": "Consultar Hist√≥rico - Filtrado por Data",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/emails/history?startDate=2025-10-01T00:00:00&endDate=2025-10-31T23:59:59",
              "host": ["{{base_url}}"],
              "path": ["api", "emails", "history"],
              "query": [
                {
                  "key": "startDate",
                  "value": "2025-10-01T00:00:00",
                  "description": "Data de in√≠cio (formato: yyyy-MM-ddTHH:mm:ss)"
                },
                {
                  "key": "endDate",
                  "value": "2025-10-31T23:59:59",
                  "description": "Data de fim (formato: yyyy-MM-ddTHH:mm:ss)"
                }
              ]
            },
            "description": "Consulta hist√≥rico filtrado por per√≠odo espec√≠fico"
          }
        },
        {
          "name": "Consultar Emails Recentes (24h)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/emails/recent",
              "host": ["{{base_url}}"],
              "path": ["api", "emails", "recent"]
            },
            "description": "Retorna emails enviados nas √∫ltimas 24 horas"
          }
        }
      ]
    },
    {
      "name": "üîß Utilit√°rios",
      "item": [
        {
          "name": "Health Check",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/emails/health",
              "host": ["{{base_url}}"],
              "path": ["api", "emails", "health"]
            },
            "description": "Verifica se o servi√ßo est√° funcionando"
          }
        },
        {
          "name": "Swagger Documentation",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/swagger-ui.html",
              "host": ["{{base_url}}"],
              "path": ["swagger-ui.html"]
            },
            "description": "Abre a documenta√ß√£o Swagger da API"
          }
        }
      ]
    },
    {
      "name": "‚ùå Testes de Erro",
      "item": [
        {
          "name": "Erro - Campo Obrigat√≥rio Faltando",
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "organizationName",
                  "value": "√ìrg√£o Teste",
                  "type": "text"
                },
                {
                  "key": "files",
                  "type": "file",
                  "src": "/path/to/test.csv"
                }
              ]
            },
            "url": {
              "raw": "{{base_url}}/api/emails/send",
              "host": ["{{base_url}}"],
              "path": ["api", "emails", "send"]
            },
            "description": "Teste de erro quando campos obrigat√≥rios est√£o faltando"
          }
        },
        {
          "name": "Erro - Arquivo N√£o CSV",
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "organizationName",
                  "value": "√ìrg√£o Teste",
                  "type": "text"
                },
                {
                  "key": "responsibleContact",
                  "value": "teste@teste.com",
                  "type": "text"
                },
                {
                  "key": "subject",
                  "value": "Teste",
                  "type": "text"
                },
                {
                  "key": "referencePeriod",
                  "value": "2025",
                  "type": "text"
                },
                {
                  "key": "dataDescription",
                  "value": "Teste de arquivo inv√°lido",
                  "type": "text"
                },
                {
                  "key": "files",
                  "type": "file",
                  "src": "/path/to/test.txt",
                  "description": "Arquivo TXT para testar valida√ß√£o"
                }
              ]
            },
            "url": {
              "raw": "{{base_url}}/api/emails/send",
              "host": ["{{base_url}}"],
              "path": ["api", "emails", "send"]
            },
            "description": "Teste de erro com arquivo que n√£o √© CSV"
          }
        }
      ]
    }
  ]
}
